<?xml version="1.0"?>

<Diamond application="spark" softwareVersion="1.0.2048.481" version="148">
    <Decoder name="Random CDR Parser" type="ascii">
        <RecordType root="true" name="Root" type="none">
            <Logic type="sequenceOf">
                <Logic recordType="RandomCDR" type="recordReference"/>
            </Logic>
        </RecordType>
        <RecordType parseQuotes="false" delimiter="comma" generate="record" allowEOFTerm="false" terminator="cr" root="false" name="RandomCDR" tokens="24" type="delimitedascii" parseDoubleQuotes="false">
            <Field trimQuotes="true" id="0" generate="field" name="EvtDttm" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true">
                <FieldConverter format="dd/MM/yyyy HH:mm:ss" type="datetime"/>
            </Field>
            <Field trimQuotes="true" id="1" generate="field" name="EvtCount" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true">
                <FieldConverter type="integer"/>
            </Field>
            <Field trimQuotes="true" id="2" generate="field" name="EvtUsage" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true">
                <FieldConverter type="integer"/>
            </Field>
            <Field trimQuotes="true" id="3" generate="field" name="CdeRevenueAmount" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true">
                <FieldConverter type="decimal"/>
            </Field>
            <Field trimQuotes="true" id="4" generate="field" name="CdeRevenueCurrency" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="5" generate="field" name="CdeInSwitch" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="6" generate="field" name="CdeOutSwitch" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="7" generate="field" name="CdeANoNOA" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="8" generate="field" name="CdeANo" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="9" generate="field" name="CdeANoExtra" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="10" generate="field" name="CdeBNoNOA" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="11" generate="field" name="CdeBNo" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="12" generate="field" name="CdeBNoExtra" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="13" generate="field" name="CdeCNoNOA" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="14" generate="field" name="CdeCNo" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="15" generate="field" name="CdeCNoExtra" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="16" generate="field" name="CdeInRoute" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="17" generate="field" name="CdeOutRoute" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="18" generate="field" name="CdeBearerService" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="19" generate="field" name="CdeCompletionCode" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="20" generate="field" name="CdeGroupKey" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="21" generate="field" name="CdeCarrierSelectCode" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="22" generate="field" name="CdePortingInPfx" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
            <Field trimQuotes="true" id="23" generate="field" name="CdePortingOutPfx" encoding="windows-1252" trimWhiteSpaceInsideQuotes="true" type="string" trimWhiteSpace="true"/>
        </RecordType>
    </Decoder>
    <Mappings>
        <Nodes>
            <Node height="50" yPos="140" xPos="15" name="RandomCDR" width="90" type="Record" recordType="RandomCDR" nodeKey="shape1">
                <Inputs/>
                <Outputs>
                    <Output name="Output"/>
                </Outputs>
            </Node>
            <Node yPos="110" unicode="false" width="60" outputKey="cdr_event" type="SparkOutput" EventUsage="evt_usage" height="50" UsagePartitionId="GetUsagePartitionId('NewSubPartitionGroup', evt_dttm, HourOfDay(evt_dttm), Mod(SecondOfMinute(evt_dttm), 2))" EventCount="evt_count" xPos="275" EventDatetime="evt_dttm" name="Rocps Output" filename="Concatenate($$Filename, '_', ToString( Now(), 'yyyyMMdd_HHmmss' ), '_', $$UsagePartitionId, '_', $$FileRecords, '.dat')" nodeKey="shape3">
                <Inputs>
                    <Input nodeOutput="Output" nodeKey="shape2">
                        <Events/>
                    </Input>
                </Inputs>
                <Outputs/>
            </Node>
            <Node height="60" yPos="85" xPos="185" name="Mapping" width="60" type="Mapping" recordType="cdr_event" nodeKey="shape2">
                <Inputs>
                    <Input nodeOutput="Output" nodeKey="shape1">
                        <Events/>
                    </Input>
                </Inputs>
                <Outputs>
                    <Output name="Output">
                        <Events>
                            <Event expression="StatisticDateTime(evt_dttm)" name="Datetime Stats" type="execute"/>
                            <Event expression="StatisticUsage(evt_usage)" name="Usage Stats" type="execute"/>
                        </Events>
                    </Output>
                </Outputs>
                <Mappings>
                    <Mapping expression="GetEventId()" target="evt_id"/>
                    <Mapping expression="EvtDttm" target="evt_dttm"/>
                    <Mapping expression="EvtCount" target="evt_count"/>
                    <Mapping expression="EvtUsage" target="evt_usage"/>
                    <Mapping expression="$$StreamId" target="stm_id"/>
                    <Mapping expression="$$TaskId" target="tsk_id"/>
                    <Mapping expression="$$StreamFileId" target="sfl_id"/>
                    <Mapping expression="CdeRevenueAmount" target="cde_revenue_amount"/>
                    <Mapping expression="CdeRevenueCurrency" target="cde_revenue_currency"/>
                    <Mapping expression="$$RecordAddress" target="record_address"/>
                    <Mapping expression="$$RecordLength" target="record_length"/>
                    <Mapping expression="CdeInSwitch" target="cde_in_switch"/>
                    <Mapping expression="CdeOutSwitch" target="cde_out_switch"/>
                    <Mapping expression="CdeANoNOA" target="cde_a_no_noa"/>
                    <Mapping expression="CdeANo" target="cde_a_no"/>
                    <Mapping expression="CdeANoExtra" target="cde_a_no_extra"/>
                    <Mapping expression="CdeBNoNOA" target="cde_b_no_noa"/>
                    <Mapping expression="CdeBNo" target="cde_b_no"/>
                    <Mapping expression="CdeBNoExtra" target="cde_b_no_extra"/>
                    <Mapping expression="CdeCNoNOA" target="cde_c_no_noa"/>
                    <Mapping expression="CdeCNo" target="cde_c_no"/>
                    <Mapping expression="CdeCNoExtra" target="cde_c_no_extra"/>
                    <Mapping expression="CdeInRoute" target="cde_in_route"/>
                    <Mapping expression="CdeOutRoute" target="cde_out_route"/>
                    <Mapping expression="CdeBearerService" target="cde_bearer_service"/>
                    <Mapping expression="CdeCompletionCode" target="cde_completion_code"/>
                    <Mapping expression="CdeGroupKey" target="cde_group_key"/>
                    <Mapping expression="CdeCarrierSelectCode" target="cde_carrier_select_code"/>
                    <Mapping expression="CdePortingInPfx" target="cde_porting_in_pfx"/>
                    <Mapping expression="CdePortingOutPfx" target="cde_porting_out_pfx"/>
                    <Mapping expression="$$RecordAddress" target="cde_record_address"/>
                    <Mapping expression="$$RecordLength" target="cde_record_length"/>
                </Mappings>
            </Node>
        </Nodes>
        <DynamicFunctions>
            <DynamicFunction objectKey="CdrEvent" name="GetEventId" blockSize="10000" type="GenerateLongId"/>
        </DynamicFunctions>
        <RecordTypes>
            <RecordType name="cdr_event">
                <Field id="24" name="evt_id" nullable="false" type="integer"/>
                <Field id="25" name="evt_dttm" nullable="false" type="datetime"/>
                <Field id="26" name="evt_count" nullable="false" type="integer"/>
                <Field id="27" name="evt_usage" nullable="false" type="integer"/>
                <Field id="28" name="stm_id" nullable="false" type="integer"/>
                <Field id="29" name="tsk_id" nullable="false" type="integer"/>
                <Field id="30" name="sfl_id" nullable="false" type="integer"/>
                <Field id="31" name="cde_revenue_amount" nullable="true" type="decimal"/>
                <Field id="32" name="cde_revenue_currency" nullable="true" type="string"/>
                <Field id="33" name="cde_record_address" nullable="true" type="integer"/>
                <Field id="34" name="cde_record_length" nullable="true" type="integer"/>
                <Field id="35" name="cde_in_switch" nullable="true" type="string"/>
                <Field id="36" name="cde_out_switch" nullable="true" type="string"/>
                <Field id="37" name="cde_a_no_noa" nullable="true" type="string"/>
                <Field id="38" name="cde_a_no" nullable="true" type="string"/>
                <Field id="39" name="cde_a_no_extra" nullable="true" type="string"/>
                <Field id="40" name="cde_b_no_noa" nullable="true" type="string"/>
                <Field id="41" name="cde_b_no" nullable="true" type="string"/>
                <Field id="42" name="cde_b_no_extra" nullable="true" type="string"/>
                <Field id="43" name="cde_c_no_noa" nullable="true" type="string"/>
                <Field id="44" name="cde_c_no" nullable="true" type="string"/>
                <Field id="45" name="cde_c_no_extra" nullable="true" type="string"/>
                <Field id="46" name="cde_in_route" nullable="true" type="string"/>
                <Field id="47" name="cde_out_route" nullable="true" type="string"/>
                <Field id="48" name="cde_bearer_service" nullable="true" type="string"/>
                <Field id="49" name="cde_completion_code" nullable="true" type="string"/>
                <Field id="50" name="cde_group_key" nullable="true" type="string"/>
                <Field id="51" name="cde_carrier_select_code" nullable="true" type="string"/>
                <Field id="52" name="cde_porting_in_pfx" nullable="true" type="string"/>
                <Field id="53" name="cde_porting_out_pfx" nullable="true" type="string"/>
            </RecordType>
        </RecordTypes>
        <Globals/>
    </Mappings>
</Diamond>
